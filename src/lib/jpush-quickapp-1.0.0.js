!function(e,t){for(var n in t)e[n]=t[n]}(exports,function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var n={};return t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=3)}([function(e,t){e.exports=require("./jcore-quickapp-1.0.0.js")},function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r,i=n(0),o=(n.n(i),this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{u(r.next(e))}catch(e){o(e)}}function a(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(s,a)}u((r=r.apply(e,t||[])).next())})}),s=this&&this.__generator||function(e,t){function n(e){return function(t){return r([e,t])}}function r(n){if(i)throw new TypeError("Generator is already executing.");for(;u;)try{if(i=1,o&&(s=2&n[0]?o.return:n[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,n[1])).done)return s;switch(o=0,s&&(n=[2&n[0],s.value]),n[0]){case 0:case 1:s=n;break;case 4:return u.label++,{value:n[1],done:!1};case 5:u.label++,o=n[1],n=[0];continue;case 7:n=u.ops.pop(),u.trys.pop();continue;default:if(s=u.trys,!(s=s.length>0&&s[s.length-1])&&(6===n[0]||2===n[0])){u=0;continue}if(3===n[0]&&(!s||n[1]>s[0]&&n[1]<s[3])){u.label=n[1];break}if(6===n[0]&&u.label<s[1]){u.label=s[1],s=n;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(n);break}s[2]&&u.ops.pop(),u.trys.pop();continue}n=t.call(e,u)}catch(e){n=[6,e],o=0}finally{i=s=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var i,o,s,a,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return a={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a},a=n.i(i.getJCore)(),u=a.report,c=a.app;!function(e){function t(e,t){var n={result:e,msg_id:t,type:"msg_status",itime:parseInt((new Date).getTime()/1e3+""),account_id:a.global.accountId};u.add(n)}function n(e){var t={op:e?0:1,type:"close_push",itime:parseInt((new Date).getTime()/1e3+"")};u.add(t)}function r(e,t){return o(this,void 0,void 0,function(){var n,r;return s(this,function(o){switch(o.label){case 0:return[4,c.getDeviceInfo()];case 1:return n=o.sent(),r={result:e,msg_id:t,sdk_type:i(n),type:"third_msg_status",itime:parseInt((new Date).getTime()/1e3+""),account_id:a.global.accountId},u.add(r),[2]}})})}function i(e){var t=0;switch(e.manufacturer.toLowerCase()){case"xiaomi":t=1;break;case"huawei":t=2;break;case"meizu":t=3;break;case"oppo":case"realme":t=4;break;case"vivo":t=5}return t}!function(e){e[e.ParseSuccess=3e3]="ParseSuccess",e[e.ParseFail=3001]="ParseFail",e[e.Show=3002]="Show",e[e.ForegroundNotShow=3003]="ForegroundNotShow",e[e.OutOfPushTime=3011]="OutOfPushTime",e[e.TimerNotifyExpire=3012]="TimerNotifyExpire",e[e.ReceiveTimerNotify=3013]="ReceiveTimerNotify",e[e.PushClick=3102]="PushClick",e[e.BrandPushClick=3102]="BrandPushClick",e[e.CustomPushClick=3103]="CustomPushClick"}(e.State||(e.State={})),e.reportMsgStatus=t,e.reportPushStatus=n,e.reportBrandMsgStatus=r}(r||(r={}))},function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r,i,o=n(0),s=(n.n(o),n(1)),a=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{u(r.next(e))}catch(e){o(e)}}function a(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(s,a)}u((r=r.apply(e,t||[])).next())})},u=this&&this.__generator||function(e,t){function n(e){return function(t){return r([e,t])}}function r(n){if(i)throw new TypeError("Generator is already executing.");for(;u;)try{if(i=1,o&&(s=2&n[0]?o.return:n[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,n[1])).done)return s;switch(o=0,s&&(n=[2&n[0],s.value]),n[0]){case 0:case 1:s=n;break;case 4:return u.label++,{value:n[1],done:!1};case 5:u.label++,o=n[1],n=[0];continue;case 7:n=u.ops.pop(),u.trys.pop();continue;default:if(s=u.trys,!(s=s.length>0&&s[s.length-1])&&(6===n[0]||2===n[0])){u=0;continue}if(3===n[0]&&(!s||n[1]>s[0]&&n[1]<s[3])){u.label=n[1];break}if(6===n[0]&&u.label<s[1]){u.label=s[1],s=n;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(n);break}s[2]&&u.ops.pop(),u.trys.pop();continue}n=t.call(e,u)}catch(e){n=[6,e],o=0}finally{i=s=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var i,o,s,a,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return a={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a},c=n.i(o.getJCore)(),l=c.log,d=c.app,f="jg_set_push_time",p="jg_timer_notify",h=!0,g="NotifyHelper";!function(e){function t(e){return new Date(e).getTime()}function n(e){l.i(g,"app in foreground: "+e),h=e}function i(e){r=e}function o(){return a(this,void 0,void 0,function(){var e,n,r,i,o;return u(this,function(s){switch(s.label){case 0:return l.i(g,"showAndStartTimerNotify"),v(),[4,d.storage.get({key:p})];case 1:if(e=s.sent(),e.length>0)for(n=JSON.parse(e),r=0;r<n.length;++r)i=n[r].content,o=(new Date).getTime(),l.i(g,"start timer notify "+n[r].msgid+", timeout:"+(t(i.n_show_begin_time)-o+1e3)),setTimeout(function(){v()},t(i.n_show_begin_time)-o+1e3);return[2]}})})}function c(e,n){return a(this,void 0,void 0,function(){var r;return u(this,function(i){if(e.n_show_begin_time&&e.n_show_begin_time.length>0||e.n_show_end_time&&e.n_show_end_time.length>0){if(r=(new Date).getTime(),l.i(g,"receive timer message "+e.n_show_begin_time+":"+t(e.n_show_begin_time)+" - "+e.n_show_end_time+":"+t(e.n_show_end_time)+", current: "+r),s.a.reportMsgStatus(s.a.State.ReceiveTimerNotify,n),e.n_show_begin_time&&r<t(e.n_show_begin_time))return y(e,n,t(e.n_show_begin_time)-r),[2];if(e.n_show_end_time&&r>t(e.n_show_end_time))return l.w(g,"timer notify out of time: "+n+" "),s.a.reportMsgStatus(s.a.State.TimerNotifyExpire,n),[2];l.i(g,"timer notify in time: "+n+", show it")}return m(e,n),[2]})})}function y(e,t,n){return a(this,void 0,void 0,function(){var r,i;return u(this,function(o){switch(o.label){case 0:return l.i(g,"start timer notify "+t+", timeout:"+n),[4,d.storage.get({key:p})];case 1:return r=o.sent(),i=[],r.length>0&&(i=JSON.parse(r)),i.push({msgid:t,content:e}),d.storage.set({key:p,value:JSON.stringify(i)}),setTimeout(function(){l.i(g,"timer notify triggered "+t),v()},n+1e3),[2]}})})}function v(){return a(this,void 0,void 0,function(){var e,n,r,i,o,a;return u(this,function(u){switch(u.label){case 0:return[4,d.storage.get({key:p})];case 1:if(e=u.sent(),e.length>0){for(n=JSON.parse(e),r=[],i=0;i<n.length;++i)o=n[i].content,a=(new Date).getTime(),o.n_show_begin_time&&a<t(o.n_show_begin_time)?r.push(n[i]):o.n_show_end_time&&a>t(o.n_show_end_time)?(l.w(g,"timer notify out of time: "+n[i].msgid+" "),s.a.reportMsgStatus(s.a.State.TimerNotifyExpire,n[i].msgid)):(m(o,n[i].msgid),l.i(g,"timer notify in time: "+n[i].msgid+", show it"));d.storage.set({key:p,value:JSON.stringify(r)})}return[2]}})})}function m(e,t){return a(this,void 0,void 0,function(){var n,i,o;return u(this,function(a){switch(a.label){case 0:return n="",(e.n_page&&(n=e.n_page,n=-1==n.indexOf("?")?n+"?_j_msgid="+t:n+"&_j_msgid="+t,e.n_extras&&(n=n+"&_j_extras="+encodeURIComponent(JSON.stringify(e.n_extras)))),"0"==e.n_display_foreground&&h)?(r&&(s.a.reportMsgStatus(s.a.State.ForegroundNotShow,t),r(e.n_title,e.n_content,n)),[3,3]):[3,1];case 1:return[4,b()];case 2:i=a.sent(),i?(s.a.reportMsgStatus(s.a.State.Show,t),e.n_title?d.notify(e.n_title,e.n_content,n):(o=d.getAppInfo(),d.notify(o.name,e.n_content,n))):s.a.reportMsgStatus(s.a.State.OutOfPushTime,t),a.label=3;case 3:return[2]}})})}function b(){return a(this,void 0,void 0,function(){var e,t,n,r,i,o;return u(this,function(s){switch(s.label){case 0:return[4,d.storage.get({key:f})];case 1:if(e=s.sent(),e.length>0){if(t=JSON.parse(e),!t.weekDays.length)return l.w(g,"receive jg push, but it's out of push time"),[2,!1];if(n=new Date,r=n.getHours(),i=n.getDay(),o=new Set(t.weekDays),!o.has(i))return l.w(g,"receive jg push, but it's out of push time"),[2,!1];if(r<t.startHour||r>t.endHour)return l.w(g,"receive jg push, but it's out of push time "+t.startHour+" - "+t.endHour+" "),[2,!1]}return[2,!0]}})})}function w(e,t,n){if(e){if(!(e instanceof Set)||t<0||t>23||n<0||n>23||t>n)return void l.e(g,"setPushTime parameters error");d.storage.set({key:f,value:JSON.stringify({weekDays:Array.from(e),startHour:t,endHour:n})})}else d.storage.del({key:f})}e.setAppInForeground=n,e.subscribeJPushNotify=i,e.showAndStartTimerNotify=o,e.handleNotify=c,e.setPushTime=w}(i||(i={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n.d(t,"JPushInterface",function(){return i});var r,i,o=n(0),s=(n.n(o),n(4)),a=n(1),u=n(5),c=n(2),l=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{u(r.next(e))}catch(e){o(e)}}function a(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(s,a)}u((r=r.apply(e,t||[])).next())})},d=this&&this.__generator||function(e,t){function n(e){return function(t){return r([e,t])}}function r(n){if(i)throw new TypeError("Generator is already executing.");for(;u;)try{if(i=1,o&&(s=2&n[0]?o.return:n[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,n[1])).done)return s;switch(o=0,s&&(n=[2&n[0],s.value]),n[0]){case 0:case 1:s=n;break;case 4:return u.label++,{value:n[1],done:!1};case 5:u.label++,o=n[1],n=[0];continue;case 7:n=u.ops.pop(),u.trys.pop();continue;default:if(s=u.trys,!(s=s.length>0&&s[s.length-1])&&(6===n[0]||2===n[0])){u=0;continue}if(3===n[0]&&(!s||n[1]>s[0]&&n[1]<s[3])){u.label=n[1];break}if(6===n[0]&&u.label<s[1]){u.label=s[1],s=n;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(n);break}s[2]&&u.ops.pop(),u.trys.pop();continue}n=t.call(e,u)}catch(e){n=[6,e],o=0}finally{i=s=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var i,o,s,a,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return a={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a},f=n.i(o.getJCore)(),p=f.log,h=f.app,g="jg_is_push_stoped",y="jg_rid_bind_success",v="JPushInterface",m=global;!function(e){function t(t,r,s){return r&&0!=r.length?(n(),f.addInitCallback(o),f.addRegisterSuccessCallback(i),p.dd(v,"action:init - jpush sdkVersion:"+e.sdkVersion),f.init(this,r,s,1,"JPush",e.sdkVersion),e):(p.ee(v,"init failed,appKey is empty,please check it"),e)}function n(){try{var e=m.changeVisiblePage;m.__proto__.changeVisiblePage=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];t&&t.length>=2&&(e.apply(this,t),t[1]?c.a.setAppInForeground(!0):c.a.setAppInForeground(!1))}}catch(e){p.ee(v,"auto check page show/hide failed:"+e)}}function i(e,t){0==e&&(r&&r(e,t),_())}function o(){f.jIsRegistered().then(function(e){e&&_(),f.subscribeNet(function(e){e?k():_()}),c.a.showAndStartTimerNotify()})}function b(e){f.jGetRegId().then(function(t){t?(p.i(v,"regid exist: "+t),e(0,t)):p.i(v,"regid not exist")}),r=e}function w(){f.jReRegister()}function _(){return l(this,void 0,void 0,function(){var e;return d(this,function(t){switch(t.label){case 0:return[4,B()];case 1:return e=t.sent(),e?e&&p.i(v,"user close the push, don't connect"):f.jIsRegistered().then(function(e){e&&s.a.connect()}),[2]}})})}function k(){s.a.disconnect()}function T(e,t,n){u.a.tagsOp(e,"add",t,n,s.a)}function S(e,t,n){u.a.tagsOp(e,"set",t,n,s.a)}function q(e,t,n){u.a.tagsOp(e,"del",t,n,s.a)}function P(e,t){u.a.tagsOp([],"clean",e,t,s.a)}function I(e,t){u.a.tagsOp([],"get",e,t,s.a)}function x(e,t,n){u.a.tagsOp([e],"valid",t,n,s.a)}function O(e,t,n){u.a.aliasOp(e,"set",t,n,s.a)}function C(e,t){u.a.aliasOp("","del",e,t,s.a)}function N(e,t){u.a.aliasOp("","get",e,t,s.a)}function J(e){return l(this,void 0,void 0,function(){var t;return d(this,function(n){switch(n.label){case 0:return[4,B()];case 1:return t=n.sent(),t?p.ii(v,"push is stoped, please invoke resumePush() to open jpush"):h.subscribe(function(t,n,r){t?e&&e(t,"brand not support or subscribe fail"):(p.ii(v,"brand rid get: "+n),s.a.sendRid(n,e))}),[2]}})})}function A(e){c.a.subscribeJPushNotify(e)}function M(e){s.a.subscribeJPushMessage(e)}function D(e,t){if(!e||"string"==typeof e&&0==e.length)e="";else{if("string"!=typeof e||!/^[+]?([0-9]+([-]?[0-9]+)*)+$/.test(e))return p.ww(v,"mobile number format error"),void t(6023,"mobile number format error");if(e.length>20)return p.ww(v,"mobile number length too long"),void t(6025,"mobile number length too long")}s.a.sendMobile(e,t)}function j(){p.dd(v,"stop push"),h.storage.set({key:g,value:!0}),a.a.reportPushStatus(!0),k(),h.unsubscribe(),h.storage.set({key:y,value:!1})}function R(){return l(this,void 0,void 0,function(){return d(this,function(e){switch(e.label){case 0:return p.dd(v,"resume push"),[4,h.storage.set({key:g,value:!1})];case 1:return e.sent(),a.a.reportPushStatus(!1),_(),J(null),[2]}})})}function B(){return l(this,void 0,void 0,function(){var e;return d(this,function(t){switch(t.label){case 0:return[4,h.storage.get({key:g})];case 1:return e=t.sent(),e?[2,"true"==e]:[2,!1]}})})}function L(e,t){return l(this,void 0,void 0,function(){var n,r,i,o,o;return d(this,function(s){switch(s.label){case 0:return p.d(v,JSON.stringify(e)),e&&Object.keys(e).length>0?e._j_msgid?(a.a.reportMsgStatus(a.a.State.PushClick,e._j_msgid),t(e._j_extras?JSON.parse(decodeURIComponent(e._j_extras)):{}),[3,3]):[3,1]:[3,4];case 1:return[4,h.getDeviceInfo()];case 2:switch(n=s.sent(),r="",i=void 0,n.manufacturer.toLowerCase()){case"xiaomi":e.JMessageExtra&&(o=JSON.parse(e.JMessageExtra),r=o._jmsgid_,i=o.m_content.n_extras);break;case"meizu":break;case"huawei":case"oppo":case"realme":e.JMessageExtra&&(o=JSON.parse(e.JMessageExtra),r=o.msg_id,i=o.n_extras)}r?(a.a.reportBrandMsgStatus(a.a.State.BrandPushClick,r),t(i)):p.ww(v,"it is not jpush msg"),s.label=3;case 3:return[3,5];case 4:p.ww(v,"msgid is null"),s.label=5;case 5:return[2]}})})}function U(e){return l(this,void 0,void 0,function(){return d(this,function(t){return"string"==typeof e?a.a.reportMsgStatus(a.a.State.CustomPushClick,e):p.ww(v,"msgid must be string"),[2]})})}function V(e,t,n){c.a.setPushTime(e,t,n)}function E(){return 2==s.a.getConnectState()}function F(e){p.dd(v,"setDebugMode:"+e),p.setDebugMode(e)}s.a.loginFail=w,e.sdkVersion="1.0.0",e.sdkVersionCode="65536",e.init=t,e.registrationID=b,e.addTags=T,e.setTags=S,e.deleteTags=q,e.cleanTags=P,e.getAllTags=I,e.validateTag=x,e.setAlias=O,e.deleteAlias=C,e.getAlias=N,e.registerQuickPush=J,e.subscribeJPushNotify=A,e.subscribeJPushMessage=M,e.setMobile=D,e.stopPush=j,e.resumePush=R,e.isPushStopped=B,e.notificationReceive=L,e.customNotificationReceive=U,e.setPushTime=V,e.getConnectionState=E,e.setDebugMode=F}(i||(i={}))},function(e,t,n){"use strict";n.d(t,"a",function(){return k});var r,i=n(0),o=(n.n(i),n(6)),s=n.n(o),a=n(7),u=(n.n(a),n(1)),c=n(2),l=n(3),d=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),f=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{u(r.next(e))}catch(e){o(e)}}function a(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(s,a)}u((r=r.apply(e,t||[])).next())})},p=this&&this.__generator||function(e,t){function n(e){return function(t){return r([e,t])}}function r(n){if(i)throw new TypeError("Generator is already executing.");for(;u;)try{if(i=1,o&&(s=2&n[0]?o.return:n[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,n[1])).done)return s;switch(o=0,s&&(n=[2&n[0],s.value]),n[0]){case 0:case 1:s=n;break;case 4:return u.label++,{value:n[1],done:!1};case 5:u.label++,o=n[1],n=[0];continue;case 7:n=u.ops.pop(),u.trys.pop();continue;default:if(s=u.trys,!(s=s.length>0&&s[s.length-1])&&(6===n[0]||2===n[0])){u=0;continue}if(3===n[0]&&(!s||n[1]>s[0]&&n[1]<s[3])){u.label=n[1];break}if(6===n[0]&&u.label<s[1]){u.label=s[1],s=n;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(n);break}s[2]&&u.ops.pop(),u.trys.pop();continue}n=t.call(e,u)}catch(e){n=[6,e],o=0}finally{i=s=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var i,o,s,a,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return a={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a},h=n.i(i.getJCore)(),g=h.log,y=h.app,v=h.loc;!function(e){e[e.Login=1]="Login",e[e.Heartbeat=2]="Heartbeat",e[e.Tags=28]="Tags",e[e.Alias=29]="Alias",e[e.Rid=27]="Rid",e[e.SDKCtrl=25]="SDKCtrl",e[e.UserCtrl=26]="UserCtrl",e[e.Message=3]="Message",e[e.ACK=19]="ACK"}(r||(r={}));var m;!function(e){e[e.disconnect=0]="disconnect",e[e.connecting=1]="connecting",e[e.connected=2]="connected"}(m||(m={}));var b,w,_,k,T="jg_rid",S="jg_user_ctrl_mobile",q="jg_user_ctrl_sdk_version",P="jg_rid_bind_success",I=29e4,x=[.1,2,5,20,60,120],O=0,C=m.disconnect,N=0,J=0,A={},M={},D=[],j=!1,R=new Set,B=["wss://quick-sis.jpush.cn"],L=-1,U="JIGUANG-Connect";!function(e){function t(){return f(this,void 0,void 0,function(){var e,t,r;return p(this,function(i){switch(i.label){case 0:return[4,l.JPushInterface.isPushStopped()];case 1:return(e=i.sent())?(g.w(U,"user close the push, don't reconnect"),[2]):C?(g.w(U,"connect existed"),[2]):(g.i(U,"start connecting"),C=m.connecting,[4,y.getNetWorkInfo()]);case 2:return t=i.sent(),"none"==t.type?(O=0,C=m.disconnect,g.dd(U,"connect failed,no network"),[2]):[4,y.storage.get({key:T})];case 3:return N=i.sent(),L<0?L=Math.floor(Math.random()*B.length):(r=Math.floor(Math.random()*(B.length-1)),L=r>=L?r+1:r),L>=B.length&&(L=B.length-1),g.d(U,"connect address "+L+": "+B[L]),setTimeout(function(){n()},500),[2]}})})}function n(){return f(this,void 0,void 0,function(){var e;return p(this,function(t){switch(t.label){case 0:return[4,l.JPushInterface.isPushStopped()];case 1:return(e=t.sent())?(g.w(U,"user close the push, don't createWs"),[2]):(b=s.a.create({url:B[L]}),b.onopen=k,b.onerror=V,b.onmessage=ee,[2])}})})}function i(){return C}function o(){if(g.i(U,"close connect"),C!=m.disconnect){j=!1,J=0,C=m.disconnect,b&&b.close({code:1e3,reason:"关闭连接",success:function(){g.i(U,"close success")},fail:function(e,t){g.e(U,"handling fail, code = "+t)}});for(var e in A){var t=A[e];t.clearRequestTimeout(),t.discardWhenDisconnect||(g.d(U,"because of disconnect , push request "+t.description()+" in pendinglist"),D.push(t))}A={},w&&clearInterval(w)}}function k(){g.i(U,"connect open"),C=m.connected,F()}function V(e){g.e(U,"connect onerror, data = "+JSON.stringify(e)),o(),E()}function E(){setTimeout(function(){t(),g.d(U,"retry, times "+O)},1e3*x[O]),++O==x.length&&(O=x.length-1)}function F(){g.i(U,"start login"),X(new _e)}function H(){g.d(U,"start heartbeat"),w=setInterval(function(){X(new ke)},I)}function K(e,t,n,r){g.d(U,"tags: "+t+" "+e);var i=new Te;i.tags=e,i.op=t,i.seq=n,i.callback=r,M[i.rid]=i,i.start20SecondsTimeout(),X(i)}function G(e,t,n,r){g.d(U,"alias: "+t+" "+e);var i=new Se;i.alias=e,i.op=t,i.seq=n,i.callback=r,M[i.rid]=i,i.start20SecondsTimeout(),X(i)}function W(e,t){var n=new Pe;n.regid=e,n.callback=t,X(n)}function z(e,t){return f(this,void 0,void 0,function(){var n,r;return p(this,function(i){switch(i.label){case 0:return[4,y.storage.get({key:S})];case 1:return(n=i.sent())&&n==e?(g.i(U,"mobile "+e+" has existed"),[2]):(r=new qe,r.property=7,r.propertyVer=e,r.callback=t,X(r),[2])}})})}function Q(){return f(this,void 0,void 0,function(){var e,t;return p(this,function(n){switch(n.label){case 0:return[4,y.storage.get({key:q})];case 1:return(e=n.sent())&&e==l.JPushInterface.sdkVersionCode?(g.i(U,"sdk isn't changed, version: "+e),[2]):(g.i(U,"upload sdk version: "+l.JPushInterface.sdkVersion),t=new qe,t.discardWhenDisconnect=!0,t.property=1,t.propertyVer=l.JPushInterface.sdkVersionCode,X(t),[2])}})})}function $(e){_=e}function X(e){!e.requireLogin||j?Y(e):D.push(e)}function Y(e){return f(this,void 0,void 0,function(){var t,n,r,i;return p(this,function(o){switch(o.label){case 0:return e.isResp?g.d(U,"request "+e.description()+" is a resp"):(A[e.rid]=e,e.startTimeout()),[4,e.requestBody()];case 1:return t=o.sent(),g.v(U,"send "+e.description()+" request, content: "+JSON.stringify(t)),n=be(h.global.uid),r=n.substring(0,16),i=h.jaesEncrypt(JSON.stringify(t.body),n,r),t.body=i,b.send({data:JSON.stringify(t),success:function(){g.i(U,"send success, request:"+e.description()+" , rid:"+e.rid)},fail:function(t,n){g.e(U,"handling fail, code = "+n+", request:"+e.description()+" , rid:"+e.rid),pe(e.rid)}}),[2]}})})}function Z(){g.i(U,"send pending request, num: "+D.length),D.forEach(function(e,t,n){Y(e)}),D=[]}function ee(e){var t=JSON.parse(e.data),n=ge(t),i=be(t.header.uid),o=i.substring(0,16);switch(t.body=JSON.parse(h.jaesDecrypt(t.body,i,o)),g.v(U,"message is "+JSON.stringify(t)),n){case r.Login:re(t);break;case r.ACK:ie(t);break;case r.Tags:oe(t);break;case r.Alias:se(t);break;case r.Rid:ae(t);break;case r.SDKCtrl:ue(t);break;case r.UserCtrl:ce(t);break;case r.Message:le(t);break;default:g.w(U,"receive unknown cmd "+n)}}function te(e){var t=ye(e);A[t]&&(A[t].clearRequestTimeout(),g.d(U,A[t].description()+"["+A[t].rid+"] resp success, and stop its timer"),delete A[t])}function ne(e){var t=ye(e);M[t]&&(g.d(U,M[t].description()+"["+M[t].rid+"] tag/alias resp success"),delete M[t])}function re(t){te(t);var n=ve(t);n.code?(g.e(U,"login fails"),o(),e.loginFail()):(g.i(U,"login success, sid: "+n.sid),O=0,J=n.sid,j=!0,Z(),H(),Q())}function ie(e){g.i(U,"tik tok, tik tok"),te(e)}function oe(e){g.i(U,"receive tags resp");var t=ye(e);if(M[t]){var n=M[t],r=ve(e);"get"==n.op&&r.curr<r.total||(n.clear20SecondesRequestTimeout(),ne(e)),0==r.code?"get"==n.op?(r.tags&&(n.tags=n.tags.concat(r.tags)),r.curr<r.total?(n.curr=r.curr+1,X(n)):n.callback(0,n.tags,n.seq)):"valid"==n.op?n.callback(0,n.tags,n.seq,r.validated):n.callback(0,n.tags,n.seq):(6==r.code&&(r.code=6007),n.callback(r.code,n.tags,n.seq))}}function se(e){g.i(U,"receive alias resp");var t=ye(e);if(M[t]){var n=M[t];n.clear20SecondesRequestTimeout(),ne(e);var r=ve(e);0==r.code?"get"==n.op?n.callback(0,r.alias,n.seq):n.callback(0,n.alias,n.seq):n.callback(r.code,n.alias,n.seq)}}function ae(e){var t=ye(e);if(A[t]){var n=A[t];te(e);0==ve(e).code?(n.callback(0,""),y.storage.set({key:P,value:!0})):(n.callback(e.code,"rid upload fail"),y.storage.set({key:P,value:!1}))}}function ue(e){var t=ve(e),n=new xe(t);n.id=t.id,n.rid=e.header.rid,X(n);var r=JSON.parse(t.ctrl);5==r.cmd&&(g.i(U,"receive loc sdk ctrl"),v.updateLocReporter(r.content.frequency,r.content.disable))}function ce(e){var t=ye(e);if(A[t]){var n=A[t];te(e);var r=ve(e);0==r.code?7==n.property?(n.callback(r.code,"mobile set success"),y.storage.set({key:S,value:n.propertyVer})):1==n.property&&(g.i(U,"user ctrl: sdk version upload success"),y.storage.set({key:q,value:n.propertyVer})):7==n.property&&(g.e(U,"user ctrl: mobile set fail"),n.callback(r.code,"mobile set fail"))}}function le(e){return f(this,void 0,void 0,function(){var t,n,r,i,o,s;return p(this,function(a){if(t=ve(e),n=new Ie(t),n.rid=e.header.rid,X(n),R.has(n.messgeID)||0!=n.msgType)g.w(U,"message existed "+n.messgeID);else{if(R.add(n.messgeID),r=t.messageContent.split("\n"),i=JSON.parse(r[r.length-1]),!(o=i.msg_id?i.msg_id:i.ad_id?i.ad_id:i._jmsgid_))return u.a.reportMsgStatus(u.a.State.ParseFail,o),[2];u.a.reportMsgStatus(u.a.State.ParseSuccess,o),i.n_only?(g.i(U,"jpush notify/message receive, msgid:"+o),s=i.m_content,c.a.handleNotify(s,o),_&&4==i.show_type&&(i.message||i.extras)&&_(i.title,i.message,o,i.extras)):(g.i(U,"jpush message receive, msgid:"+o),(i.message||i.extras)&&_(i.title,i.message,o,i.extras))}return[2]})})}function de(e){A[e]&&(g.i(U,"request "+e+" timeout, request: "+A[e].description()),o(),E())}function fe(e){var t=null;A[e]&&(t=A[e],delete A[e]),M[e]&&(t=M[e],delete M[e]);for(var n=0;n<D.length;n++)if(D[n].rid==e){t=D[n],D.splice(n,1);break}g.d(U,t.description()+"["+t.rid+"] request 20s timer time out "),t.callback(6002,null,t.seq)}function pe(e){A[e]&&(g.i(U,"request "+e+" fail, request: "+A[e].description()),o(),E())}function he(){var e=N%2>0?N:++N;return N>1e5&&(N=1,e=N),++N,y.storage.set({key:T,value:N}),e}function ge(e){return e.header.cmd}function ye(e){return e.header.rid}function ve(e){return e.body}function me(e){var t=0;switch(e.manufacturer.toLowerCase()){case"xiaomi":t=1;break;case"huawei":t=2;break;case"meizu":t=3;break;case"oppo":case"realme":t=4;break;case"vivo":t=5}return t}function be(e){var t=0;switch(e%10){case 1:t=5*e+e%88;break;case 2:t=23*e+e%15;break;case 3:t=3*e+e%73;break;case 4:t=13*e+e%96;break;case 5:t=17*e+e%49;break;case 6:t=7*e+e%68;break;case 7:t=31*e+e%39;break;case 8:t=29*e+e%41;break;case 9:t=37*e+e%91;break;default:t=8*e+e%74}var n="JCKP"+t;return a.MD5(n).toString()}e.connect=t,e.getConnectState=i,e.disconnect=o,e.tagsOp=K,e.aliasOp=G,e.sendRid=W,e.sendMobile=z,e.subscribeJPushMessage=$;var we=function(){function e(){this.discardWhenDisconnect=!1,this.requireLogin=!0,this.isResp=!1,this.cmd=0,this.rid=0,this.rid=he()}return e.prototype.startTimeout=function(){var e=this;this.timer=setTimeout(function(){return de(e.rid)},1e4)},e.prototype.requestHeader=function(){return{cmd:this.cmd,rid:this.rid,sid:J,uid:""+h.global.uid}},e.prototype.requestBody=function(){return f(this,void 0,void 0,function(){return p(this,function(e){return[2,{header:this.requestHeader(),body:{}}]})})},e.prototype.clearRequestTimeout=function(){this.timer&&clearTimeout(this.timer)},e.prototype.description=function(){return""},e}(),_e=function(e){function t(){var t=e.call(this)||this;return t.cmd=r.Login,t.requireLogin=!1,t.discardWhenDisconnect=!0,t}return d(t,e),t.prototype.requestBody=function(){return f(this,void 0,void 0,function(){var t,n,r,i,o,s;return p(this,function(u){switch(u.label){case 0:return[4,e.prototype.requestBody.call(this)];case 1:return t=u.sent(),[4,y.getDeviceInfo()];case 2:return n=u.sent(),[4,y.getNetWorkInfoCode()];case 3:return r=u.sent(),[4,v.getLocCache()];case 4:return i=u.sent(),o=me(n),[4,y.storage.get({key:P})];case 5:return s=u.sent(),s&&(o|=128),t.body={fromResource:"q",passwdmd5:a.MD5(h.global.password).toString(),sdkVersion:h.global.sdkVersionCode+"|"+l.JPushInterface.sdkVersionCode,appkey:h.global.appkey,platform:"q",flag:1,rom:o,loginType:r,deviceId:h.global.deviceid,country:n.region,accountID:h.global.accountId,locInfo:{lat:i.lat,lng:i.lng,time:i.itime}},[2,t]}})})},t.prototype.description=function(){return"[Login]"},t}(we),ke=function(e){function t(){var t=e.call(this)||this;return t.cmd=r.Heartbeat,t.discardWhenDisconnect=!0,t}return d(t,e),t.prototype.requestBody=function(){return f(this,void 0,void 0,function(){var t;return p(this,function(n){switch(n.label){case 0:return[4,e.prototype.requestBody.call(this)];case 1:return t=n.sent(),t.body={},[2,t]}})})},t.prototype.description=function(){return"[Heartbeat]"},t}(we),Te=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.cmd=r.Tags,t.curr=1,t.op="",t.tags=[],t.seq=0,t.platform="q",t}return d(t,e),t.prototype.requestBody=function(){return f(this,void 0,void 0,function(){var t;return p(this,function(n){switch(n.label){case 0:return[4,e.prototype.requestBody.call(this)];case 1:return t=n.sent(),t.body={tags:"get"!=this.op?this.tags:[],platform:"q",op:this.op},"get"==this.op?t.body.curr=this.curr:"valid"==this.op&&(t.body.tags=this.tags[0]),[2,t]}})})},t.prototype.start20SecondsTimeout=function(){var e=this;this.timer20s=setTimeout(function(){return fe(e.rid)},2e4)},t.prototype.clear20SecondesRequestTimeout=function(){this.timer20s&&clearTimeout(this.timer20s)},t.prototype.description=function(){return"[Tags]"},t}(we),Se=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.cmd=r.Alias,t.op="",t.alias="",t.seq=0,t.platform="q",t}return d(t,e),t.prototype.requestBody=function(){return f(this,void 0,void 0,function(){var t;return p(this,function(n){switch(n.label){case 0:return[4,e.prototype.requestBody.call(this)];case 1:return t=n.sent(),t.body={alias:this.alias,platform:"q",op:this.op},[2,t]}})})},t.prototype.start20SecondsTimeout=function(){var e=this;this.timer20s=setTimeout(function(){return fe(e.rid)},2e4)},t.prototype.clear20SecondesRequestTimeout=function(){this.timer20s&&clearTimeout(this.timer20s)},t.prototype.description=function(){return"[Alias]"},t}(we),qe=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.cmd=r.UserCtrl,t.property=0,t.operator=1,t.propertyVer="",t.platform="q",t}return d(t,e),t.prototype.requestBody=function(){return f(this,void 0,void 0,function(){var t;return p(this,function(n){switch(n.label){case 0:return[4,e.prototype.requestBody.call(this)];case 1:return t=n.sent(),t.body={property:this.property,operator:this.operator,propertyVer:this.propertyVer,platform:"q"},[2,t]}})})},t.prototype.description=function(){return"[UserCtrl]"},t}(we),Pe=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.cmd=r.Rid,t.regid="",t}return d(t,e),t.prototype.requestBody=function(){return f(this,void 0,void 0,function(){var t,n;return p(this,function(r){switch(r.label){case 0:return[4,e.prototype.requestBody.call(this)];case 1:return t=r.sent(),[4,y.getDeviceInfo()];case 2:return n=r.sent(),t.body={regid:this.regid,rom:me(n),platform:"q"},[2,t]}})})},t.prototype.description=function(){return"[Rid]"},t}(we),Ie=function(e){function t(t){var n=e.call(this)||this;return n.cmd=r.Message+1,n.code=0,n.msgType=0,n.isResp=!0,n.msgType=t.msgType,n.messgeID=t.messgeID,n}return d(t,e),t.prototype.requestBody=function(){return f(this,void 0,void 0,function(){var t;return p(this,function(n){switch(n.label){case 0:return[4,e.prototype.requestBody.call(this)];case 1:return t=n.sent(),t.body={code:this.code,msgType:this.msgType,messgeID:this.messgeID},[2,t]}})})},t.prototype.description=function(){return"[Message]"},t}(we),xe=function(e){function t(t){var n=e.call(this)||this;return n.cmd=r.SDKCtrl,n.code=0,n.isResp=!0,n}return d(t,e),t.prototype.requestBody=function(){return f(this,void 0,void 0,function(){var t;return p(this,function(n){switch(n.label){case 0:return[4,e.prototype.requestBody.call(this)];case 1:return t=n.sent(),t.body={code:this.code,id:this.id},[2,t]}})})},t.prototype.description=function(){return"[SDKCtrl]"},t}(we)}(k||(k={}))},function(e,t,n){"use strict";n.d(t,"a",function(){return c});var r,i=n(0),o=(n.n(i),n.i(i.getJCore)()),s=o.log,a=o.jgetByteLen,u="tagAlias";!function(e){e[e.Succeed=0]="Succeed",e[e.TagsAliasBothNil=6001]="TagsAliasBothNil",e[e.Timeout=6002]="Timeout",e[e.AliasInvalid=6003]="AliasInvalid",e[e.AliasTooLong=6004]="AliasTooLong",e[e.TagsInvalid=6005]="TagsInvalid",e[e.TagsTooLong=6006]="TagsTooLong",e[e.TagsTooMany=6007]="TagsTooMany",e[e.TagsAliasPkgTooLong=6008]="TagsAliasPkgTooLong",e[e.Unknow=6009]="Unknow",e[e.TooFrequent=6011]="TooFrequent",e[e.TooBusy=6014]="TooBusy",e[e.BlackList=6015]="BlackList",e[e.InvalidUser=6016]="InvalidUser",e[e.InvalidReq=6017]="InvalidReq",e[e.TagsTooManyTags=6018]="TagsTooManyTags",e[e.TagsGetTagsFail=6019]="TagsGetTagsFail",e[e.ServerUnavailable=6020]="ServerUnavailable",e[e.TagsInUse=6021]="TagsInUse",e[e.AliasInUse=6022]="AliasInUse",e[e.PacketLengthExceed=6026]="PacketLengthExceed",e[e.AliasQuantityExceed=6027]="AliasQuantityExceed"}(r||(r={}));var c;!function(e){function t(e){for(var t=0;t<e.length;++t){var n=e.charCodeAt(t);if(!(48<=n&&n<=57||65<=n&&n<=90||97<=n&&n<=122||95==n||19968<=n&&n<=40959||33==n||64==n||35==n||36==n||38==n||42==n||43==n||61==n||46==n||124==n))return!1}return!0}function n(){var e=(new Date).getTime()/1e3;return p.length>=10&&e-p[0]<=10?(s.w(u,"curent tag/alias request is over 10 times in 10 second"),!1):(p.push(e),p.length>10&&p.shift(),!0)}function i(e){if(!e||!e.length)return r.TagsAliasBothNil;if(!Array.isArray(e))return r.TagsInvalid;if(e.length>1e3)return r.TagsTooMany;for(var n=0,i=0;i<e.length;++i){var o=e[i],s=a(o);if("string"!=typeof o||!o.length)return r.TagsInvalid;if(s>40)return r.TagsTooLong;if(!t(o))return r.TagsInvalid;n+=s}return n>5e3?r.TagsAliasPkgTooLong:r.Succeed}function o(e,t,o,s,a){if(n()){if(d)return void s(r.TagsInUse,e,o);if(d=!0,"get"!=t&&"clean"!=t){var u=i(e);if(u!=r.Succeed)return d=!1,void s(u,e,o)}a.tagsOp(e,t,o,function(e,t,n,r){d=!1,s(e,t,n,r)})}else s(r.TooFrequent,e,o)}function c(e){return e&&e.length?"string"!=typeof e?r.AliasInvalid:a(e)>40?r.AliasTooLong:t(e)?r.Succeed:r.AliasInvalid:r.TagsAliasBothNil}function l(e,t,i,o,s){if(n()){if(f)return void o(r.AliasInUse,e,i);if(f=!0,"set"==t){var a=c(e);if(a!=r.Succeed)return f=!1,void o(a,e,i)}s.aliasOp(e,t,i,function(e,t,n){f=!1,o(e,t,n)})}else o(6011,e,i)}var d=!1,f=!1,p=[];e.tagsOp=o,e.aliasOp=l}(c||(c={}))},function(e,t){e.exports=require("@system.websocketfactory")},function(e,t){e.exports=require("crypto-js")}]));
//# sourceMappingURL=jpush_v1.0.0.js.map
